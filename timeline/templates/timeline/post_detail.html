{% extends 'base.html' %}

{% block content %}

<div class="text-left">
    <h2>{{post.title}}</h2>
    <h7>
        <a href="{% url 'userpage' post.user.pk %}">{{post.user.username}} さん</a>
    </h7>
    <p>{{post.prefecture}}</p>
    <p>[旅行日]  {{post.start_date}} ～ {{post.end_date}}</p>
    <p>[メモ]  {{post.memo}}</p>
    {% if post in login_user_information.like_post.all %}
    <a href="{% url 'like-remove' post.pk %}" class="btn">いいね済み</a>
    {% else %}
    <a href="{% url 'like' post.pk %}" class="btn">いいねする</a>
    {% endif %}
    <p>
        {% for tag in post.tags.all %}
        <span class="badge bg-light text-dark">
            {{tag}}
        </span>
        {% endfor %}
    </p>
    {% for album in album_list %}
    <div class="row mt-3 mb-3">
        {% for Photos in photo_list %}
            <!-- 写真があるアルバム名だけ表示させる -->
            {% if album == Photos.0.album %}
                <a href="{% url 'photo-list' album.diary.pk album.pk %}">{{ album.location }}</a>
            {% endif %}
            {% for Photo in Photos %}
                {% if album == Photo.album %}
                    <div class="col-2 d-flex align-items-center">
                        <img src="{{ Photo.photo.url }}" alt="{{ Photo.album }}"  class="border w-100 d-block mx-auto">
                    </div>
                {% endif %}
            {% endfor %}
        {% endfor %}
        <br>
    </div>
    {% endfor %}
  <br>
  
{% for comment in comment_list %}
    <p>{{ comment.user }}</p>
    <p>{{ comment.text }}</p>
    {% for reply in reply_list %}
        {% if reply.comment == comment %}
            <p>　↳{{ reply.text }}</p>
        {% endif %}
    {% endfor %}
{% endfor %}

  <h4 class="mt-3">コメント</h4>
    <form action="{% url 'comment' post.pk %}" method="post">
     {% csrf_token %}
      {{ comment_form }}
    <div class="mt-2">
      <button type="submit">追加</button>
    </div>
  </form>
</div>

{% if user == post.user %}
    <a href="{% url 'diary-detail' post.pk %}">編集</a>
{% endif %}


{% endblock %}